version: '3.1'

services:
  gitautomation:
    image: gitautomation
    build:
      context: ./GitAutomation
      dockerfile: Dockerfile
    secrets:
      - gitcredentials
      - configuration.json
    ports:
      - "32768:80"
    volumes:
      - "./GitAutomation.AllAddons/obj/Docker/publish:/extra-bins/all-addons"
#  gitautomation-sql:
    #image: gitautomation-sql
#    build:
#      context: ./GitAutomation.Sql
#      dockerfile: Dockerfile
#    ports:
#      - "1433"
#    secrets:
#      - sqlcredentials
#      - sqleula

  gitautomation-psql:
    image: gitautomation-psql
#    build:
#      context: ./GitAutomation.Postgres
#      dockerfile: Dockerfile
#    ports:
#      - "5432"
#    secrets:
#      - sqlcredentials
#      - sqleula


secrets:
  gitcredentials:
    file: ./git-credentials.txt
#  sqlcredentials:
#    file: ./sql-credentials.txt
#  sqleula:
#    file: ./sql-eula.txt
  configuration.json:
    file: ./configuration.json
